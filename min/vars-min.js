const rng=(e=4)=>Math.floor(Math.random()*e),colors={player:"#fff",inSight:{walkable:"transparent",unwalkable:"#000",enemy:"#940404"},unseenOrUnwalkable:"#000",outOfSight:"#00000066",fovHighlight:"#3370d422",walkHighlight:"#08fa2555"},narrator={start:[e=>e+" has entered the dungeon...",e=>`but will ${e} find the exit?`,"...what was that voice?  Is someone there?","Use the WASD keys to move your character. Hint: It's the White box ;)","ok....thanks?","**whoever you are**","the green squares are where you can move to on your turn","you can also hover yourself and check your stats","you'll also notice a block button...that will use all the actions you have left and convert half of it to defense","use it wisely"],fog:["Tiles you have not explored yet are completely hidden by the fog of war.","Tiles you've discovered will stay visible until they are out of your field of view (FOV).","You'll remember the dungeon layout, but you'll no longer be able to see 'activity'","So watch out!","There could be vampires","WHO ARE YOU?!"],enemy:["That....is an enemy","If you want to check out it's stats or attack just look at it!","....or hover your mouse over it for those that don't have extra sensory abilities",'....whelp.  Guess the "jokes" are just gonna keep coming'],taunting:["you're going the wrong way","you sure the exit is over there?","you're never leaving....muahahahaha","no don't go that way!!","good luck....","you sure you want to go that way?","don't leave me...ha you can't!","trust me....this is NOT a dream","I will always be here for you...whether or not you like it","I'm in your head and I'm not leaving....just like you aren't leaving here!"],gameOver:[e=>`....looks like ${e} was not able to find the exit`,e=>`didn't think ${e} would`,"well at least the jokes can stop now"],aoo:[e=>e+"....here's the deal",".....","you can try to run if you want","but if the enemy has seen you and you've seen them...","all you're doing by running is giving them a free shot at you","and if they hit you...your turn is OVER!","so you're better off sticking around for the fight...","if you can hack it","you can have this one for free....next one won't be"]},_createNameInput=document.querySelector("#createName"),game=document.querySelector("#gameBG"),ctx=game.getContext("2d"),body=document.querySelector("body"),_btnStart=document.querySelector(".toggle-game"),_btnReset=document.querySelector(".reset"),_container=document.querySelector(".container"),_landing=document.querySelector(".headline"),_cursorModal=document.querySelector("#cursorModal"),_help=document.querySelector(".help"),_lvlUpAtk=document.querySelector("#lvlUpAtk"),_lvlUpDef=document.querySelector("#lvlUpDef"),_lvlUpAgil=document.querySelector("#lvlUpAgil"),_lvlUpActions=document.querySelector("#lvlUpActions"),_lvlUp=document.querySelector(".level-up"),_enemyDetails=document.querySelector(".enemy-details"),_chatBox=document.querySelector(".chat-box"),_chatMessageGroup=document.querySelector(".chat-message-group"),_playAgain=document.querySelector("#playAgain"),_newGameBtn=document.querySelector(".play-again-btn"),_newCharacterBtn=document.querySelector(".new-character-btn"),NUMBER_OF_ROWS=16,NUMBER_OF_COLUMNS=16,CHECKER_INT=Math.pow(14,2)+2,CANVAS_HEIGHT=256,CANVAS_WIDTH=256,ROWS=new Array(16).fill(),COLUMNS=new Array(16).fill(),TILE_HEIGHT=16,TILE_WIDTH=16,WALKABLE_TILE_CHANCE=.8,xyMax=240,COORDINATES={},WALKABLE_COORDINATES=[];let player,handleKeyPress,enemyCount,steps=0,dungeon=1,dungeonEXP=20+10*dungeon,lvl=1,playerCoord=[],enemies=[],totalEnemyPower=100;const enemyPowerMult=()=>lvl%5==0?totalEnemyPower=~~(1.5*totalEnemyPower):0;let moveTimer,exit;const start=[];let firstEnemySpotted,startedTyping,walkableTiles=0,enemyIndex=0,firstAOO=1,helpDisabled=0;_help.addEventListener("change",()=>helpDisabled=!helpDisabled);